project: sweep-synthetic-small-non-parametric
checkpoint_interval: 30
default_root_dir: experiments/sweep
use_smart_trainer: True
agent_run_args:
  count: 10
sweep_configuration:
  method: bayes
  metric:
    goal: minimize
    name: metrics/best-backward_relative_penalty
  parameters:
    trainer:
        max_epochs:
            sweep: True
            values: [300, 1000, 5000, 10000]
    model:
        init_args:
            model_args:
                share_parameters:
                    sweep: True
                    values: [False, True]
            optimizer_args:
            - weight_decay: 
                sweep_identifier: theta-weight-decay
                sweep: True
                values: [0.25, 1.0, 5.0, 10.0]
            - weight_decay: 0.1
    data:
        sweep: True
        sweep_alias:
        - 2-chain
        - 3-chain
        - 3-erdos
        - 3-full
        - 4-chain
        - 4-erdos
        - 4-full
        - 5-chain
        - 5-erdos
        - 5-full
        - 10-erdos
        values:
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_2_1000_chain
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: chain, n: 2, seed: 220}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 138
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 776
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_3_1000_chain
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: chain, n: 3, seed: 324}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 343
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 595
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_3_1000_erdos_renyi
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: erdos_renyi, n: 3, p: 0.65, seed: 324}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 119
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 71
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_3_1000_full
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: full, n: 3, seed: 829}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 804
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 123
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_4_1000_chain
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: chain, n: 4, seed: 21}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 841
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 749
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_4_1000_erdos_renyi
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: erdos_renyi, n: 4, p: 0.65, seed: 658}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 898
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 55
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_4_1000_full
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: full, n: 4, seed: 440}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 82
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 332
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_5_1000_chain
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: chain, n: 5, seed: 115}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 473
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 804
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_5_1000_erdos_renyi
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: erdos_renyi, n: 5, p: 0.65, seed: 94}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 852
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 457
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
                batch_size: 128
                dataset: ocd.data.SyntheticOCDDataset
                dataset_args:
                    name: non_parametric_non_linear_gaussian_5_1000_full
                    observation_size: 1000
                    scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                    scm_generator_args:
                        graph_generator: ocd.data.scm.GraphGenerator
                        graph_generator_args: {graph_type: full, n: 5, seed: 14}
                        noise_mean: 0.0
                        noise_std: 1.0
                        s_gamma_rbf_kernel: 1.0
                        s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                                \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                            function_of_interest: func}
                        s_mean_function_activation_signature: softplus
                        s_mean_function_weights: [0.01, 0.1]
                        s_variance_rbf_kernel: 1.0
                        seed: 786
                        t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                                \ numpy.sin(x) + x", function_of_interest: func}
                        t_mean_function_activation_signature: sin_plus_x
                        t_mean_function_weights: [0.01, 0.1]
                        t_variance_rbf_kernel: 1.0
                    seed: 895
                val_size: 0.1
        - class_path: lightning_toolbox.DataModule
          init_args:
            batch_size: 128
            dataset: ocd.data.SyntheticOCDDataset
            dataset_args:
                name: non_parametric_non_linear_gaussian_10_1000_erdos_renyi
                observation_size: 1000
                scm_generator: ocd.data.synthetic.GaussianProcessBasedSCMGeberator
                scm_generator_args:
                    graph_generator: ocd.data.scm.GraphGenerator
                    graph_generator_args: {graph_type: erdos_renyi, n: 10, p: 0.65, seed: 831}
                    noise_mean: 0.0
                    noise_std: 1.0
                    s_gamma_rbf_kernel: 1.0
                    s_mean_function_activation: {function_descriptor: "def func(x):\n    x[x\
                            \ < 100] = numpy.log(1 + numpy.exp(x[x < 100]))\n    return x",
                        function_of_interest: func}
                    s_mean_function_activation_signature: softplus
                    s_mean_function_weights: [0.01, 0.1]
                    s_variance_rbf_kernel: 1.0
                    seed: 576
                    t_mean_function_activation: {function_descriptor: "def func(x):\n    return\
                            \ numpy.sin(x) + x", function_of_interest: func}
                    t_mean_function_activation_signature: sin_plus_x
                    t_mean_function_weights: [0.01, 0.1]
                    t_variance_rbf_kernel: 1.0
                seed: 966
            val_size: 0.1
