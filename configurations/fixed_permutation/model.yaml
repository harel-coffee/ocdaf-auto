class_path: lightning_toolbox.TrainingModule
init_args:
  # the model
  model_cls: ocd.models.ocdaf.OCDAF
  model_args:
    base_distribution: torch.distributions.Normal
    base_distribution_args:
      loc: 0.0
      scale: 1.0
    in_features: 3
    layers: [3, 3]
    num_transforms: 3
    additive: False
    elementwise_perm: True
    ordering: [0, 2, 1]
    learn_permutation: False
    residual: False
    bias: true
    activation: torch.nn.LeakyReLU
  # the optimizer
  optimizer: torch.optim.AdamW
  # the loss
  objective_args:
    nll: "lambda training_module, batch: training_module.model(batch)['log_prob'].mean()"
